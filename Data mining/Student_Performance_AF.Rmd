---
title: "Performance des étudiants"
author: "Corre, Feteira, Lenoir"
date: ""
lang: fr
output: 
 pdf_document:
    df_print: kable
    keep_tex: yes
    number_section: yes
    toc: yes 
 rmdformats::readthedown:
   gallery: no
   highlight: tango
   lightbox: yes
   self_contained: yes
editor_options:
  chunk_output_type: console
---

```{r setup, echo = FALSE, cache=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE, fig.height = 5.5, fig.width = 12, 
                      sanitize = TRUE, echo = FALSE, cache = TRUE)
```

```{r tikz-sanitize}
options(
tikzSanitizeCharacters = c('%','}','{','^','_','&','~',"é","É","è","È","à","À"),
tikzReplacementCharacters = c('\\%','\\}','\\{','\\^{}','\\_{}',
'\\&','\\char`\\~',"\\'e","\\'E","\\`e","\\`E","\\`a","\\`A")
)
options(Encoding="UTF-8")
```

```{r, cache = FALSE}
library(FactoMineR)
library(ggplot2)
library(factoextra)
library(tidyverse)
library(kableExtra)
library(readxl)
library(stringr)
library(ggpubr)
library(ggsci)
library(scales)
library(dplyr)
library(tidyverse)
library(questionr)
library(labelled)
library(DT)
library(gridExtra)
library(grid)
library(rmdformats)
library(corrplot)
library("gplots")
library("NbClust")

library(doParallel) ## le PC devient une F1 après
cl <- detectCores() %>% -1 %>% makeCluster
registerDoParallel(cl)
```

\newpage

# Introduction et modification des données

À la suite de notre analyse descriptive, nous allons effectuer une analyse factorielle complète sur nos données. Nous avions regroupé nos variables en 4 catégories (renseignements, environnement familial, milieu scolaire et milieu extra-scolaire), nous allons donc réaliser une ACM sur trois des 4 catégories car la catégorie renseignement ne comportait que trop peu de variables et seront mises en variables supplémentaires.
Nous allons également, en fonction des résultats obtenus, réaliser une ou plusieurs AFC et classifications. Tout ceci a pour but final de dégager des groupes et sous groupes d'étudiants qui peuvent montrer les facteurs de réussites et d'échecs scolaires au Portugal.

Pour cela, nous avons modifié nos données en créant seulement des variables qualitatives et en adaptant les modalités pour aider à la compréhension.

Deux variables sont le coeur de notre travail, elles seront utilisées dans chacune de nos parties: 

- Gradetot : Moyenne de l'étudiant

- Matiere : Matière étudiée



```{r, cache = FALSE}
################ Import ###########################
source("fonction.R")
data_mat<-read.csv("student-mat.csv", sep= ";")
data_por<-read.csv("student-por.csv", sep= ";")

############## creation moyenne ###################
data_mat$gradetot= (data_mat$G1 + data_mat$G2 + data_mat$G3)/3
data_por$gradetot= (data_por$G1 + data_por$G2 + data_por$G3)/3

############## creation matiere ###################
data <- rbind(data_mat,data_por)
data$matiere<-"math"
data$matiere[c(396:1044)]<-"portugais"

############# nettoyage variable age ##############
data_mat <- clean(data_mat)
data_por <- clean(data_por)
data<-clean(data)

############ variable traveltime #################
data$traveltime[data$traveltime==1] <- "trav < 15"
data$traveltime[data$traveltime==2] <- "trav 15-30"
data$traveltime[data$traveltime==3] <- "trav 30-1h"
data$traveltime[data$traveltime==4] <- "trav > 1h"

############ variable studytime ##################
data$studytime[data$studytime==1] <- "stud < 2h"
data$studytime[data$studytime==2] <- "stud 2-5h"
data$studytime[data$studytime==3] <- "stud 5-10h"
data$studytime[data$studytime==4] <- "stud > 10h"

############ variable Medu #######################
data$Medu[data$Medu == "0"] <- "niveau 0"
data$Medu[data$Medu == "1"] <- "niveau 1"
data$Medu[data$Medu == "2"] <- "niveau 2"
data$Medu[data$Medu == "3"] <- "niveau 3"
data$Medu[data$Medu == "4"] <- "niveau 4"

########### variable Fedu ########################
data$Fedu[data$Fedu == "0"] <- "niveau 0"
data$Fedu[data$Fedu == "1"] <- "niveau 1"
data$Fedu[data$Fedu == "2"] <- "niveau 2"
data$Fedu[data$Fedu == "3"] <- "niveau 3"
data$Fedu[data$Fedu == "4"] <- "niveau 4"

########### variable famrel #####################
data$famrel[data$famrel == "1"] <- "Très mauvaise"
data$famrel[data$famrel == "2"] <- "Mauvaise"
data$famrel[data$famrel == "3"] <- "Moyenne"
data$famrel[data$famrel == "4"] <- "Bonne"
data$famrel[data$famrel == "5"] <- "Très bonne"


########### variable classe #####################
for (i in 1:nrow(data)){
  if(data$age[i] - data$failures[i] == 15){data$classe[i] <- "10eme"}
  else if(data$age[i] - data$failures[i] == 16){data$classe[i] <- "11eme"}
  else if(data$age[i] - data$failures[i] %in% c(17, 18)){data$classe[i] <- "12eme"}
}

########### variable absence ####################
data$absences <- as.factor(cut(data$absences, c(0, 5, 10, 75), 
                               labels = c("abs [0,5]", "abs ]5,10]", "abs ]10,75]"),
                               include.lowest = TRUE))

########### variable alcool #####################
for (i in 1:nrow(data)){
  data$alcool[i]<-(data$Walc[i]+data$Dalc[i])/2
  for (j in 1:5){
    if (data$alcool[i]==j+0.5){data$alcool[i]<-j+1}
  }
}

######### variable failures #####################
data$failures[data$failures==2] <- "2 ou 3"
data$failures[data$failures==3] <- "2 ou 3"

######## base de données pour acm ###############
data<-data[,-c(3,27,28,31:33)]
data_acm<-data
data_acm$gradetot<-cut(data_acm$gradetot,c(0,5,10,15,20),
                   labels=c("moy [0,05]", "moy ]05,10]", "moy ]10,15]", "moy ]15,20]"))

for (i in 1:31){data_acm[, i] <- as.character(data_acm[, i])}
```

\newpage

# L'impact de l'environnement familial

Dans cette partie, les variables liées à l'environnement familial seront étudiées :

- Famsize : Le nombre de personnes dans le foyer

- Pstatut : Le staut conjugal des parents

- Medu et Fedu : Le niveau d'étude des parents

- Mjob et Fjob : La catégorie socioprofessionnelle des parents

- Guardian : Le tuteur de l'étudiant

- Famsup : Soutient à l'éducation 

- Famrel : Niveau de qualité des relations familiales

## ACM

### Premières modélisations

```{r}
corrplot(cramer.matrix(data_acm[,-c(1:3,10,12:15,17:22,24:27,30,31)]),type="upper",diag=FALSE,tl.col="black")

```

D'après la matrice de corrélation, les variables les plus corrélés entre elles sont Medu avec Fedu et Mjob et Fedu avec Fjob.
Ceci semble logique puisque en général, le métier de la mère et du père dépend de son niveau d'étude.
De plus, le fait que Medu et Fedu ainsi que Mjob et Fjob soient corrélées peut nous indiquer que les parents se sont probablement rencontrés pendant leurs études ou au travail.


```{r}
acm <- MCA(data_acm ,quali.sup=c(1:3,10,12:15,17:22,24:27,30,31) ,graph = FALSE, ncp = 24)
```

Tout d'abord, jetons un premier coup d'oeil à notre nuage des individus et des variables.

```{r}
habillage(acm, n = "none")
```
 
On remarque que le nuage des individus a une forme du type de l'effet Guttman. De plus, on a une très forte concentration des individus du coté gauche de l'axe 2 et une concentration moins importante du côté droit.
 

```{r}
var <- str_sub(rownames(acm$var$coord), start = 1, end = 13)
var_contrib(acm, col.var = "contrib", gradient.cols = colors1)
```

 
Les variables qui semblent contribuer le plus sont Medu, Fedu, Mjob et Fjob. De plus, les modalités concernant le niveau 1 et 4 d'éducation semblent le plus contribuer pour les variables Medu et Fedu ainsi que les modalités "teacher" et "at_home" pour les variables Fjob et Mjob.
L'effet Guttman qui apparait dans le nuage des individus est sûrement expliqué par ces variables.

 

### Inerties

```{r}
pourcent_var_val_prop(acm, "variance", 10,ncp=10)
```

On remarque que la dimension 1 à une part de variance expliquée de 9%, pour l'axe 2, nous tombons à 5.7%. Les axes suivants sont très proches. Ici nous choisissons de garder les 2 premiers axes.


### Contributions

On regarde quels individus contribuent le plus : 

```{r}
contrib(acm, choix = "ind", axes = c(1:2), ncol = 1, nrow =2, taille = 8, top = 50)
```

On regarde maintenant les individus qui contribuent le plus à chaque axe :

```{r, cache = FALSE}
tab_ind_1 <- data_acm[c(116, 731, 300, 111), c(4:9,11,16,23,28,29)]
tab_fun(tab_ind_1, title = "Individus qui contribuent le plus à l axe 1", font_size = 6)
```

Les étudiants 125, 760 et 321 contribuent le plus à la dimension 1. Une première chose que l'on remarque pour ces étudiants est que les SCP mères et pères sont identiques pour tous les individus. De même, le niveau d'éducation des parents est souvent très proches. Pour ces étudiants nous pouvons également remarquer que les niveaux élevés d'éducation des parents permettent une meilleure moyenne.

```{r, cache = FALSE}
tab_ind_2 <- data_acm[c(965, 1006, 980, 523), c(4:9,11,16,23,28,29)]
tab_fun(tab_ind_2, title = "Individus qui contribuent le plus à l axe 2", font_size = 6)
```
 
Pour la dimension 2, l'individu 1000 est celui qui contribue le plus, ensuite nous avons les étudiants 1041 et 1015 qui contribuent quasiment de la même manière.
Tout les étudiants ont leurs parents qui vivent ensemble, un père qui travaille dans les services et ont tous passé le portugais.
On remarque également que comme pour la dimension 1, lorsque les deux parents ont un niveau d'éducation faible, la moyenne de l'élève baisse, ce qui est le cas pour l'étudiant 1000.


Pour les variables :

```{r}
contrib(acm, choix = "var", axes = c(1:2), ncol = 2, nrow = 1)
```
 
Pour l'axe 1, il semble que ce soit le niveau d'éducation qui contribue le plus avec une distinction entre le niveau maximum (4) et le niveau 1. Mais nous pouvons également voir apparaitre Fjob et Mjob teacher ainsi que Mjob et Fjob at home. Donc cela semble séparer les parents qui ont beaucoup d'éducation et qui travaillent dans le secteur de l'éducation et les parents qui ont peu d'éducation et qui travaillent à la maison.
L'axe 2 semble également discriminer par le niveau d'éducation, cette fois-ci le niveau 3 apparait ainsi que Fjob et Mjob services.
C'est donc la variable education qui donne cette forme au nuage des individus. En effet, l'axe 1 sépare niveau 1 et niveau 4 donc niveau faible et élevé alors que l'axe 2 sépare niveau 1 et niveau 3.

\newpage

### Nuage des individus

Pour les axes 1 et 2:

```{r}
ggarrange(plotlist = boucle_habillage(acm, c(1:9), axes = c(1, 2)),
          ncol = 3, nrow = 3)
```
 
Sur ce graphique, on remarque bien que les variables Medu et Fedu se répartissent du niveau d'éducation le plus faible au niveau le plus élevé sur l'axe 1.
Mjob et Fjob semblent se répartir un peu de la même manière, ce qui est logique puisque dans la matrice de corrélation, nous avions une corrélation positive entre ces 4 variables.

Pour la variable school, l'école Gabriel Pereira qui semblait se situer à la ville dans l'analyse descriptive à beaucoup d'individu situés sur la droite, donc des individus dont les parents ont un niveau d'éducation élevé.
De plus, pour l'école Mousinho da Silveira, les étudiants sont situés sur la gauche donc ce sont des étudiants avec des parents qui ont un niveau plus faible d'éducation.

```{r}
ggarrange(plotlist = boucle_habillage(acm, c(11,23,28,29), axes = c(1, 2)),
          ncol = 2, nrow = 2)
```
 
Pour toutes les autres variables de notre analyse, nous ne retrouvons pas de résultats très clairs et précis. Les autres variables semblent être expliquées dans d'autres dimensions.


Pour finir, nous allons regarder plus en détail la variable gradetot qui donne la moyenne de l'étudiant en fonction de l'explication des axes déterminés précèdemment.

```{r}
fviz_mca_ind(acm,geom="point",xlim=c(-1.5,2.5),
             habillage = 28, palette=choix_pal,
             ggtheme=theme_minimal(),axes=c(1,2))
```
 
Sur les axes 1 et 2, il y a une tendance qui se dégage, les très bonnes notes sont plutôt du côté droit, ce qui signifie que les meilleures notes sont plutôt pour les personnes dont le niveau d'éducation des parents est élevé (supérieur au niveau 3).
Et au contraire beaucoup de points rouges et oranges sont sur la gauche, ce qui signifie que le niveau d'éducation des parents est faible et les notes sont plutôt mauvaises.


 
En conclusion de cette ACM, seuls les axes 1 et 2 sont vraiment intéressants à regarder et à analyser. Ces axes montrent que plus le niveau d'éducation de la mère ou du père est élevé, plus la CSP associée semble être dans les secteurs de l'éducation et de la santé. Ceci est logique puisqu'il faut faire des études pour travailler dans ces secteurs. Au contraire ceux avec moins d'éducation travaillent plus à la maison ou dans le secteur administratif et du service.

Pour les notes des étudiants on peut en conclure que plus le niveau d'éducation est élevé plus les notes semblent bonnes. Et donc, par correspondance les enfants de medecins et de professeurs réussissent mieux.

Il serait donc intéressant de faire une AFC sur les variables Medu, Fedu, Mjob et Fjob en lien avec les notes pour confirmer les résultats obtenus.

## AFC CSP mère-notes

Tout d'abord, nous avons réalisé plusieurs AFC sur les variables Medu, Fedu, Mjob et Fjob toutes en relation avec la variable gradetot (Moyenne de l'étudiant). Pour chaque AFC réalisée, les résultats étaient similaires.
Nous avons gardé cette AFC car elle semblait être la plus intéressante et présentait les résultats les plus clairs.

### Tableaux de données
```{r}
G3_total <- cut(data$gradetot, c(0,4,8,12,14,16,18,20), 
              right = FALSE, include.lowest = TRUE)


levels(G3_total) <- c("entre 0 et 4","entre 4 et 8", "entre 8 et 12", "entre 12 et 14", "entre 14 et 16","entre 16 et 18", "entre 18 et 20")
notes_res_G3 <-table(G3_total, data$Mjob)

```

Voici le tableau de contingence sur lequel nous allons travailler : 

```{r}
tab_fun(notes_res_G3, title = "Repartition des etudiants selon la moyenne et les CSP de la mere", above =FALSE,font_size = 10)
```

On remarque dans ce tableau qu'il y a une surreprésentation pour les notes entre 8 et 16.

```{r}
afc<-as.data.frame.matrix(notes_res_G3) 

```

### Test khi-deux

```{r}
testchi<-chisq.test(afc)
testchi<-as.data.frame(testchi[1:3])
testchi$p.value<-format(testchi$p.value,scientific=T,digits = 3) 
tab_fun(testchi,above = F,title = "Test du Khi-deux")

```

La p-value est très faible, on rejette l'hypothèse d'indépendance, les notes et les CSP sont liées, on peut faire une AFC.

### Inerties

```{r}
resca<-CA(afc,graph=F)
```

Tout d'abord voici un graphique qui représente les parts d'inertie cumulées : 

```{r,fig.height=6}
fviz_screeplot(resca,addlabels=T,ylim=c(0,80),ncp=5) + 
  ggtitle("Diagrammes des inerties") + 
  ylab("Pourcentage de variances expliquees")
```
 
L'axe 1 explique 72% de la liaison entre les modalités et les deux premiers axes expliquent 91% de la variance.
On garde donc deux axes pour effectuer notre AFC.

\newpage

### Contributions

En ce qui concerne les contributions, voici un graphique qui permet d'obtenir les contributions pour la dimension 1 pour les profils lignes et colonnes:

```{r}
contrib_row<-fviz_contrib(resca,choice="row")
contrib_col<-fviz_contrib(resca,choice="col")
grid.arrange(contrib_row,contrib_col,nrow=1,ncol=2)
```
 
Pour les profils lignes, on remarque que les contributions aux deux premiers axes séparent les bonnes notes des mauvaises notes.

Pour les profils colonnes, on remarque que les personnes travaillant dans les secteurs de la santé et travaillant à la maison sont celles qui contribuent le plus pour les CSP.

En conclusion, on peut dire que les bonnes et mauvaises notes expliquent principalement l'axe 1.

 
Voici un tableau des contributions qui résument les résultats obtenus graphiquement.

```{r}
tab_fun(round(resca$row$contrib,2), above=FALSE, title= "Contributions pour chaque axes des profils lignes")
```


Maintenant que nous avons determiné le nombre d'axe et que nous avons analysé les contributions pour les profils lignes et colonnes, représentons graphiquement les résultats de l'AFC.

\newpage

### Représentations graphiques

Pour finir, représentons les profils lignes et colonnes sur le même graphique : 

```{r}
points2<-data.frame(resca$row$coord[,c(1,2)])
colnames(points2)<-c("x","y")
fviz_ca_biplot(resca,repel=T) + geom_line(aes(x=x,y=y),data=points2,color="blue")
```

La représentation de l'axe 1 discrimine les bonnes et mauvaises notes. On voit bien que sur la gauche de l'axe des ordonnées, nous avons les mauvaises notes (entre 0 et 12) et sur la droite, les bonnes notes (entre 12 et 20).
On remarque également que les éleves dont la mère travaille dans le secteur de la santé ou de l'éducation ont des meilleures notes que les élèves dont la mère travaille à la maison. Cela renvoie aux observations faites dans l'analyse descriptive. 

```{r}
fviz_ca_biplot(resca,map="rowgreen",arrow=c(T,T),repel=T)
```

On ajoute les directions pour confirmer notre analyse sur le graphique précèdent.
Sur ce graphique, on arrive à mieux distinguer les CSP, et surtout teacher et health. On peut en conclure que les étudiants qui réussissent le mieux sont les fils dont la mère travaille dans l'éducation et ceux qui réussissent le moins, les enfants dont la mère travaille à la maison.

\newpage

# Impact des activités extra-scolaires

Comme vu dans notre analyse descriptive, les variables liées aux activités extra-scolaires sont : 

- Romantic : Statut relationnel de l'étudiant

- Internet : Accès à internet à la maison

- Freetime : Niveau de temps libre 

- Goout: Niveau de sortie avec des amis

- Alcool : Niveau de consommation d'alcool

## ACM

Dans cette partie, nous avons choisi d'interpréter les variables liées à l'extra scolaire : goout, freetime, romantic, internet, Dalc et Walc. 

On a pu constater que les deux variables liées à l'alcool étaient corrélées. Le coefficient de corrélation entre ces deux variables est le suivant :

- `r round(cor(data_por$Dalc,data_por$Walc,method = "pearson"),2)` pour les élèves ayant étudié le portugais. 

 
- `r round(cor(data_mat$Dalc,data_mat$Walc,method = "pearson"),2)` pour ceux ayant étudié les maths. 


Nous avons donc créé une nouvelle variable : "alcool" qui représente la consommation d'alcool la semaine et le week-end. 

```{r}
var_sup<-c(1:20,23,26:27,30)
vec_var<-c(21,22,24,25,28,31)
corrplot(cramer.matrix(data_acm[,-var_sup]),type="upper",diag = F,tl.col = "black")
```

La variable qui représente les sorties entre amis est corrélée avec deux autres variables : le niveau de temps libre et la consommation d'alcool.

```{r}
acm_2<-MCA(data_acm,ncp=20,quali.sup = c(var_sup,29),graph = F)
```

```{r}
habillage(acm_2, n = "none")
```

Pour les deux premiers axes, on voit que la représentation des individus à une forme en v. La plupart des individus sont situés à gauche et quelques individus sont situés en haut à droite.

### Inertie

```{r,fig.height=6}
pourcent_var_val_prop(acm_2,ncp=10)
```

Nous décidons de garder nos 4 premiers axes, ce qui correspond à une inertie de `r round(acm_2$eig[4,3],1)`%

### Variables

```{r}
contrib(acm_2,choix = "var", axes = c(1:4), ncol = 2, nrow = 2)
```

Sur les deux premiers axes, les nombreuses sorties entre amis et le temps libre important contribuent beaucoup à ces deux axes : 

- Sur l'axe 1, goout_5 contribue à plus de 20%.

- Freetime_5 et goout_4 contribuent à eux deux presque 30% de l'axe 2.

Sur le troisième axe, la modalité "internet_no" contribue le plus avec également les modalités les plus basses des sorties entre amis, de la consommation d'alcool et du temps libre.

Sur notre quatrième axe, nous voyons que les moyennes élevées contribuent à presque 20%. Mais aussi que les modalités moyennes des variables du temps libre et des sorties entre amis y contribuent pour plus de 10% chacune. 

 
### Individus

```{r}
contrib(acm_2, choix = "ind", axes = c(1:4), ncol = 2, nrow =2, taille = 8, top = 30)
```

```{r}
data_acm[c(57,887,92,473,937),-var_sup] %>% tab_fun(above = F,title = "Individus à forte contribution sur l'axe 1")
```

Les individus qui contribuent le plus à l'axe 1 sont presques identiques sur de nombreux points : individus qui ont beaucoup de temps libre, qui sortent beaucoup, qui ont une consommation d'alcool dans la semaine comme le week-end et donc à cause de cela, des moyennes inférieures à 10.

```{r}
data_acm[c(812,435,57,887),-var_sup] %>% tab_fun(above = F,title = "Individus à forte contribution sur l'axe 2")
```

Les individus qui contribuent à l'axe 2 sont pour la plupart identiques à ceux qui contribuent à l'axe 1 : beaucoup de temps libre, beaucoup de sortie et beaucoup d'alcool.

```{r}
data_acm[c(369,218,628,970,1007),-var_sup] %>% tab_fun(above = F,title = "Individus à forte contribution sur l'axe 3")
```

Sur notre axe 3, les individus sont l'opposé de ceux de l'axe 1 et 2 : ils n'ont pas internet, ne sont pas en couple, n'ont pas beaucoup de temps libre, ne sortent pas beaucoup et ne boivent pas d'alcool. À part l'étudiant 390 qui a une moyenne très faible, les autres ont des moyennes plus élevées que les individus des deux premiers axes. 

```{r}
data_acm[c(125,958,245,673),-var_sup] %>% tab_fun(above = F,title = "Individus à forte contribution sur l'axe 4")
```

Ici, on distingue deux groupes d'individus qui sont très différents et qui contribuent à l'axe 4 :

- Ceux qui ont une moyenne très basse (en dessous de 5), qui ne boivent pas d'alcool, qui sortent à une fréquence moyenne, qui n'ont pas internet et qui sont en couple.

- Ceux qui ont une moyenne très élevée (au dessus de 15), qui boivent plus que la moyenne, sortent beaucoup, qui ont internet et sont en couple. 

Ces deux groupes sont biens distincts mais les individus qui font partie du même groupe sont exactement pareils. 


### Analyse des individus et des variables.

```{r}
ggarrange(plotlist=boucle_habillage(acm_2,vec_var,axes = c(1,2)))
```

Sur la représentation des axes 1 et 2, on constate que chaque modalité des variables goout, freetime et alcool est bien représentée distinctement des autres. La modalité supérieure de ces 3 variables est située en haut à droite de leur graphique. Sur la gauche, les modalités inférieures sont représentées. L'axe 1 représente donc la tendance de ces trois variables.
Pour les variables internet, romantic et gradetot, il est difficile de trouver une tendance générale.

```{r}
ggarrange(plotlist=boucle_habillage(acm_2,vec_var,axes = c(3,4)))
```

Sur ces deux axes, deux variables sont mieux représentées que les autres. Les individus qui ont internet sont situés sur la gauche et ceux qui ne l'ont pas, sur la droite. Les individus avec une moyenne élévée sont sur la partie haute du graphique et plus la moyenne descend, plus ils se placent vers le bas. Toutes les autres modalités des variables sont assez dispersées sur ces deux axes.

```{r}
ggarrange(
  var_contrib(acm_2,col.var = "contrib",gradient.cols = colors1),
  var_contrib(acm_2,axes=c(3,4),col.var = "contrib",gradient.cols = colors1)
)
```

Comme vu dans la matrice de corrélation, on voit que alcool, freetime et goout sont liées. Sur l'axe 1 et 2, la modalité supérieure de ces 3 variables contribue beaucoup à ces deux axes. Ce qui signifie que plus un étudiant a du temps libre, plus il va sortir avec ses amis et plus il va consommer d'alcool.

Le deuxième graphique signifie que si un étudiant ne possède pas internet, il aura en moyenne des moins bonnes notes. 

Dans les prochains graphiques, nous allons représenter les deux premiers axes avec l'axe 4 qui représente les bonnes moyennes. À côté de la contribution pour ces axes, on décide de faire une représentation des individus pour la moyenne avec les mêmes axes choisis.  

```{r}
ggarrange(
  var_contrib(acm_2,axes=c(1,4),col.var = "contrib",gradient.cols = colors1),
  var_contrib(acm_2,axes=c(2,4),col.var = "contrib",gradient.cols = colors1)
)
```

Nous constatons que plus un individu va avoir de temps libre ou sortir avec ses amis, plus sa moyenne sera basse. 
Comme vu précédemment, si un individu a beaucoup de temps libre, il va donc beaucoup sortir avec ses amis et donc sa moyenne sera encore plus basse. 

### Recapitulatif

```{r,fig.height=6}
ggarrange(
fviz_mca_biplot(acm_2, invisible = "quali.sup", axes = c(1,2),
                select.ind = list(contrib=10),
                select.var = list(contrib=3)),
fviz_mca_biplot(acm_2, invisible = "quali.sup", axes = c(3,4),
                select.ind = list(contrib=10),
                select.var = list(contrib=3))
)
```

Nous avons décidé de représenter les 3 variables et les 10 individus qui contribuent le plus à leurs axes.
Sur les deux premiers axes, on constate bien que se sont les individus en haut à droite qui contribuent le plus où ils ont comme spécificité d'avoir beaucoup de temps libre et de beaucoup sortir avec leur amis. 
Sur les deux axes suivants, les individus qui contribuent le plus sont situés dans le quart en bas à droite. Ces individus font contribuer les modalités "internet_no" et sont à l'opposé des moyennes élevées, ce qui renforce cette modalité. 

## AFC alcool-notes

```{r}
data_test<-data_acm[,vec_var]
vec_test<-c(1:4,6)
test_khi_deux(data_test, vec_test, 5, 
              title = "p-value des tests du khi-deux pour les variables extra-scolaire")
```

On constate que toutes les p-values sont inférieures à 0.05 sauf la variable freetime donc on peut rejeter l'hypothèse d'indépendance. 
Nous ne traitons pas la variable romantic et internet car le nombre de modalité est trop faible. Nous décidons de travailler sur la variable "alcool" car dans l'ACM qui précède, on a pu constater que cette variable était importante sur tous les axes mais ne contribuait pas de manière importante.

```{r}
G3_total<-cut(data$gradetot,c(0,8,10,12,14,16,20),labels = c("Inf 8","Entre 8-10", "Entre 10-12","Entre 12-14","Entre 14-16","Sup 16"))
data_acm$alcool<-factor(data_acm$alcool,levels = 1:5,labels = c("TP","P","M","E","TE"))
```

```{r}
note_alcool<-table(G3_total, data_acm$alcool)
```

```{r}
tab_fun(note_alcool,above = F,title = "Tableau de contingence")
```

On voit que la consommation très importante d'alcool est une modalité rare. 

```{r}
afc1<-as.data.frame.matrix(note_alcool) 
```

### Inerties

```{r}
resca<-CA(afc1,graph=F)
```

```{r}
fviz_eig(resca,addlabels=T,ylim=c(0,110),ncp=5) + 
  ggtitle("Diagrammes des inerties") + 
  ylab("Pourcentage de variances")
```

En conservant les deux premiers axes, on obtient `r round(resca$eig[2,3],2)`% d'inertie. Le second axe va juste nous permettre une bonne représentation de nos modalités.

### Profils lignes-colonnes

```{r}
g1<-fviz_contrib(resca,choice="row")
g2<-fviz_contrib(resca,choice="col")
ggarrange(g1,g2,nrow = 1,ncol=2)
```

```{r}
tab_lignes<-tab_fun(round(resca$row$contrib,2), above=FALSE, title= "Contributions pour chaque axes des profils lignes")
tab_colonnes<-tab_fun(round(resca$col$contrib,2), above=FALSE, title= "Contributions pour chaque axes des profils colonnes")
tab_lignes
tab_colonnes
```

On constate que pour les profils lignes, les individus ayant eu entre 8 et 10 et entre 12 et 16 contribuent à l'axe 1 pour presque 70%. 
Pour les profils colonnes, la contribution à l'axe 1 est due à trois modalités: très peu, moyen et élevé. Ces 3 modalités contribuent entre 20 et 30% chacune.

### Illustrations

```{r}
points2<-data.frame(resca$row$coord[,c(1,2)])
colnames(points2)<-c("x","y")

a<-fviz_ca_biplot(resca,repel=T) + geom_line(aes(x=x,y=y),data=points2 )
```

```{r}
b<-fviz_ca_biplot(resca,map="rowgreen",arrow=c(T,T),repel=T)
ggarrange(a,b,ncol = 2,nrow = 1)
```
 
Ici, nous pouvons constater que nos analyses passées étaient correctes :

- À gauche, nous avons les moyennes élevées et la consommation faible d'alcool.

- À droite, les moyennes plus faibles et une consommation d'alcool plus élevée.

- Quand la consommation d'alcool est très peu importante, les notes sont meilleures. 

- Plus la consommation est élevée, plus les notes sont basses. On peut observer les individus qui ont des moyennes inférieures à 8 ont un vecteur qui se place sur celui des individus qui ont une consommation d'alcool très élevée.

\newpage

# Impact du milieu scolaire.

Ici, l'impact du milieu scolaire sera étudié. Les variables liées à ce milieu sont les suivantes : 

- School : L'école de l'étudiant

- Reason : La raison du choix de l'école

- Traveltime : Temps de trajet pour aller à l'école

- Studytime : Temps de travail par semaine

- Failures : Nombre de redoublement

- Schoolsup : Soutient extra-scolaire

- Paid : Cours supplémentaire payé

- Nursery : L'étudiant a été en maternelle

- Absences : Nombre d'absences

- Classe : Classe de l'étudiant

## ACM

On décide maintenant de faire une ACM sur les variables du milieu scolaire. Pour cela on regarde la matrice de corrélation de ces variables :

```{r}
corrplot(cramer.matrix(data_acm[,c(1, 10, 12:15, 17, 19, 20, 27:30)]),
         type="upper", diag=FALSE, tl.col="black")
```

On remarque que paid est très corrélée avec matière. En effet, on sait de notre première analyse que les étudiants prenaient souvent un professeur particulier en mathématiques. De plus, la variable school est corrélé avec traveltime et avec quasiment toutes les autres variables (sauf nursery). Comme nous l'avions vu dans le premier rapport, les étudiants de l'école Gabriel Pereira habitent plutôt relativement proche de l'école (moins de 15 minutes), tandis que les étudiants de l'école Mousinho da Silveira habitent un peu plus loin (entre 15 et 30 minutes) en moyenne. Enfin, la variable failures est corrélée avec higher et gradetot, ce qui nous semble assez logique car moins nos notes sont bonnes, plus l'on redouble et moins l'on a envie de continuer à faire des études (les mauvaises notes sont souvent liées au fait que l'on aime pas l'école).  
Nous faisons l'ACM, ce qui nous donne les parts de variance expliquée suivantes :

```{r}
acm_scol <- MCA(data_acm, quali.sup = c(2:9, 11, 16, 18, 21:26, 31), graph = FALSE, ncp = 20)
pourcent_var_val_prop(acm_scol, "variance", 10, ncp = 10)
```

On a 16.4% d'inertie sur les 2 premiers axes.

Voici le graphique des individus sur l'axe 1 et 2 : 

```{r}
habillage(acm_scol, n = "none")
```

Quelques individus expliquant un peu plus l'axe 1 et 2 mais globalement gros nuage de points. Néanmoins, on observe une forte concentration des points en bas et à gauche. 

```{r}
var <- str_sub(rownames(acm_scol$var$coord), start = 1, end = 13)
var_contrib(acm_scol, col.var = "contrib", gradient.cols = colors1)
```

Les modalités expliquant l'axe 1 et l'axe 2 sont celles qui représentent le fait d'avoir de mauvaises notes tout en ayant une taille d'échantillon plus faible que les autres (c'est pour cela que les points se détachent du centre). On y retrouve donc le fait de ne pas vouloir faire d'études supérieures (higher_no), le fait d'avoir redoublé au moins 1 fois (failures_1 et failures_2 ou 3), le fait d'être absent plus de 10 fois dans l'année (abs ]10,75]), le fait de payer un professeur particulier (paid_yes) et la matière mathématiques.  
L'axe 1 est également expliqué par les étudiants qui ont un trajet entre 30 minutes et 1 heure (trav 30-1h) et l'école Mousinho da Silveira (MS).


### Variables

On étudie les contributions des variables sur les 2 premiers axes car les axes 3 et 4 ne nous apportent aucune information :

```{r}
contrib(acm_scol, choix = "var", axes = c(1:2), ncol = 2, nrow = 1)
```

On remarque que les modalités qui contribuent le plus à l'axe 1 sont le fait de ne pas vouloir faire d'études supérieures (higher_no) et le fait d'être dans l'école Mousinho da Silveira (MS). Les deux autres modalités qui contribuent de façon assez conséquente sont le fait d'avoir redoublé 1 fois (failures_1) et le fait d'étudier moins de 2 heures par semaine (stud < 2). Ces modalités contribuent à presque 39% de l'axe 1.  
Les modalités qui contribuent le plus à l'axe 2 sont les mathématiques (et le portugais mais moins car les notes sont meilleures), le fait d'être absent plus de 10 fois (abs ]10,75]), le fait de prendre des cours particuliers (paid_yes), le fait de redoubler 1 fois (failures_1) et le fait d'avoir une moyenne entre 5 et 10 (moy ]5,10]). Ces modalités contribuent à 60% de l'axe 2.

### Individus

On regarde quels individus contribuent le plus : 

```{r}
contrib(acm_scol, choix = "ind", axes = c(1:2), ncol = 1, nrow =2, taille = 8, top = 50)
```

On regarde maintenant les individus qui contribuent le plus à chaque axe :

```{r, cache = FALSE}
tab_1 <- data_acm[c(944, 966, 933, 971), c(1, 10, 12:15, 17, 19, 20, 27:30)]
tab_fun(tab_1, title = "Individus qui contribuent le plus à l axe 1", font_size = 6)
```

```{r, cache = FALSE}
tab_2 <- data_acm[c(250, 193, 196, 197), c(1, 10, 12:15, 17, 19, 20, 27:30)]
tab_fun(tab_2, title = "Individus qui contribuent le plus à l axe 2", font_size = 6)
```

Les étudiants 979, 1001 et 967 contribuent le plus à l'axe 1 car ils étudient moins de 2 heures par semaine et ont une moyenne entre 0 et 5 tout en ayant redoublé au moins une fois, en étant dans l'école Mousinho da Silveira et ne voulant pas faire d'études supérieures (ils n'aiment très certainement pas l'école). L'étudiante 1006 comporte les mêmes caractéristiques, sauf qu'elle travaille de 2 à 5 heures par semaine. Étant donné que l'on est sur la matière portugais, on peut penser que soit cette étudiante a menti sur le temps de travail par semaine qu'elle fait, soit qu'elle est dyslexique car son niveau de santé est très bas, ce qui peut l'handicaper dans ce cours.  
Du côté de l'axe 2, les individus 271, 214, 217 et 218 sont surtout ceux qui sont souvent absents (plus de 10 fois), dans la matière des mathématiques tout en ayant redoublé au moins une fois en prenant des cours particuliers et en travaillant de 2 à 5 heures par semaine. Il s'agit très certainement d'étudiants en difficultés ou alors qui n'aiment pas les mathématiques mais qui sont forcés par leurs parents à en faire.  

```{r}
ggarrange(plotlist = boucle_habillage(acm_scol, c(1, 10, 13:15, 17, 20, 27:29), axes = c(1, 2)),
          ncol = 3, nrow = 4)
```
  
- Variable school : l'école Mousinho da Silveira représente toute la partie en bas à droite au niveau de l'axe 1.

- Variable reason : les raisons liées au domicile proche de l'école et la réputation sont plutôt au niveau des bonnes notes.

- Variable studytime : les étudiants qui travaillent plus de 5 heures par semaine se situent au niveau des bonnes notes tandis que les étudiants qui travaillent moins de 2 heures par semaine se situent au niveau des mauvaises notes.

- Variable failures : les étudiants ayant redoublé au moins une fois se situent au niveau des mauvaises notes en haut à droite. 

- Variable schoolsup : l'aide vient surtout au niveau de la matière mathématiques en haut à gauche. 

- Variable paid : les étudiants ayant payé des cours personnels se retrouvent en haut à gauche au niveau de l'axe 2. 

- Variable higher : les étudiants qui ne veulent pas faire d'études supérieures sont représentés sur l'axe 1 (au niveau des redoublements et des mauvaises notes). 

- Variable absences : comme vu précédemment, on retrouve les individus les plus absents sur l'axe 2. Nous remarquons également que les étudiants ayant redoublé au moins une fois ne sont pas forcément beaucoup absents. 

- Variable gradetot : on remarque que la moyenne semble avoir une relation croissante entre les axes 1 et 2, c'est-à-dire qu'à mesure que l'on augmente la valeur dans l'axe 1 et 2, les notes descendent.

- Variable matiere : il semblerait que l'axe des abscisses les coupe en deux avec le portugais en bas et les mathématiques en haut. Cependant, on remarque que les mauvaises notes se situent beaucoup en portugais (ce qui peut être lié aux différences de taille d'échantillon entre les deux matières), tout comme les très bonnes. 

- Pour terminer, les variables traveltime, nursery et classe n'apportaient rien donc nous ne les avons pas mises.

### Récapitulatif

Les axes 1 et 2 représentent les variables qui font que les notes sont mauvaises, les facteurs de non réussite à l'école (redoublements, moyenne en dessous de la moyenne, veut pas faire d'études supérieures, étudiants absents, mathématiques qui sont moins réussis que le portugais).

\newpage

# Classification

## Environnement familial

### K-means

Nous utilisons tout d'abord la méthode des k-means qui est une technique de la méthode de partitionnement.

Nous cherchons le nombre optimal de cluster proposé par cette méthode :

```{r}
silhouette<-fviz_nbclust(acm$ind$coord, kmeans, method = "silhouette")
plot(silhouette)
```

D'après la méthode silhouette dans la méthode de partitionnement des k-means, le nombre de clusters optimal serait de 5.

```{r}
km.res <- kmeans(acm$ind$coord, centers = 5, nstart = 20) 
```


### CAH

À la suite de la méthode par partitionnement, nous faisons un classification hiérarchique pour comparer les deux méthodes : 

```{r}
cah_acm_consol <- HCPC(acm, nb.clust=2, min = 2, consol= TRUE, graph=FALSE)
```

Tout d'abord, voici un tableau qui présente le gain d'inertie entre la CAH avec et sans consolidation.

```{r}
before<-round(cah_acm_consol$call$bw.before.consol,3)
after<-round(cah_acm_consol$call$bw.after.consol,3)
tot<-cbind(before,after)
rownames(tot)<-"variance"
tot %>% tab_fun(above=F,title="Gain d'inertie après consolidation")
```

Nous pouvons constater une augmentation de l'inertie de 0.04 lorsque nous passons de sans à avec consolidation.

```{r}
fviz_dend(cah_acm_consol, cex = 0.5, k_colors = c(col_ind, col_var, orange),
          main = "Classification", subtitle = "avec la méthode de Ward")
```

En observant le dendogramme, nous pouvons dire que les 5 clusters proposés par la méthode de partitionnement ne semblent pas vraiment être en adéquation avec le dendogramme présent ci-dessus où l'on peut estimer que 2 clusters serait le meilleur choix.

Pour appuyer nos propos, comparons les représentations des clusters pour la méthode des k-means et la méthode CAH.

 
```{r}
ggarrange(
  fviz_cluster(km.res,acm$ind$coord[,1:2], geom = "point", 
               show.clust.cent = FALSE, palette = "futurama", 
               ggtheme = theme_minimal()) + lims(x= c(-1.5,1.5))+ 
    labs(title= "K-means avec 5 clusters"),
  fviz_cluster(cah_acm_consol, geom="point", ellipse = TRUE, show.clust.cent = FALSE, palette = "futurama", 
               ggtheme = theme_minimal()) + lims(x= c(-1.5,1.5)) + 
    labs(title= "CAH avec 2 clusters"),
  ncol = 2
)
```

Il semble clairement que la méthode des k-means n'est pas optimale, les clusters se superposent et donc le graphique n'est pas lisible, on n'arrive pas à degager 2 clusters distinctement.
Si on utilise la CAH, on constate bien 2 clusters bien différents qui semblent être coupés par un axe vertical.

\newpage

### Modalités des variables pseudo-test de proportions

```{r}
mod_classe(cah_acm_consol, nbr_classe = 1:2, sup = 7)
```

Voici le tableau représentant les modalités des variables les plus présentes dans le premier cluster.

```{r}
classe_1
```

Interprétation pour le cluster 1 :

- 96% de la modalité Medu_niveau2 est présente dans le cluster et représente 38% des individus dans celui-ci. 

- Si on regarde Medu_niveau1, Medu_niveau2 et Medu_niveau3, les trois représentent 93% des individus de ce cluster : on peut dire que dans ce cluster, les étudiants dont les mères ont fait très peu d'études sont majoritaires. 

- Pour le niveau d'étude du père, la part d'étudiants dont le père a fait très peu d'études dans ce cluster monte jusqu'à 71%. 

- La SCP de la mère joue égalament un rôle dans la création du cluster car si on additionne Mjob_other et Mjob_at_home, 75% des étudiants de ce cluster prennent ces 2 modalités.

En conclusion du cluster 1, il représente les étudiants dont les parents ont un faible niveau d'études et dont la mère travaille à la maison ou prennant la modalité others.

```{r}
classe_2
```

Interprétation cluster 2:
 
- La modalité Medu_niveau4 est présente pour près de 92% des individus de ce cluster. Les 4 autres modalités de cette variable représentent donc que 9%.

- Pour la modalité Fedu_niveau4, 81% des individus de cette modalité sont dans ce cluster et 60% des individus de ce cluster ont un père qui a un niveau d'éducation très élevé.

- Pour les CSP, 96% des mères et pères professeurs sont situés dans ce second cluster.

- Également concernant les SCP, entre 80 et 83% des mères et pères dans le système de santé font partie de ce cluster.

En conclusion, on voit clairement que l'étudiant type de ce cluster correspond à l'étudiant dont les parents ont un haut niveau d'études. Ce qui fait que les étudiants dont les parents travaillent dans les secteurs de l'éducation et de la santé sont très présents.


Finalement, grâce à ces deux tableaux, on retrouve bien les résultats obtenus lors de l'ACM où le premier axe séparait le niveau d'éducation mais également les CSP des parents des étudiants. 
De plus, grâce à l'AFC réalisée sur les CSP on peut en conclure que les deux clusters séparent les étudiants ayant en général une bonne note et étant fils de professeurs ou de médecins et les étudiants ayant une moins bonne note et étant fils de parents qui travaillent à la maison ou dans la catégorie "other".


## Environnement scolaire

Notre objectif est de faire une classification non supervisée sur notre ACM sur les variables du milieu scolaire. On décide de garder les 20 premiers axes car ils comprennent 91% de l'information totale. Par la méthode des k-means on détermine une première découpe :

```{r}
silhouette_scol <- fviz_nbclust(acm_scol$ind$coord, kmeans, method="silhouette")
plot(silhouette_scol)
```

Le nombre de cluster optimal serait donc de 4. On regarde notre dendrogramme pour voir si cela pourrait être cohérent :

```{r}
cah_milieu_scol_test <- HCPC(acm_scol, kk = Inf, graph = FALSE, min = 2, max = 10, consol=TRUE)
fviz_dend(cah_milieu_scol_test, show_labels = TRUE, k_colors = c(col_ind, col_var, orange))
```

Ici, il semblerait plutôt que l'on ai 2 clusters bien distinct. Nous allons donc faire notre classification ascendante hiérarchique avec 2 clusters.

Tout d'abord, voici un tableau qui présente le gain d'inertie entre la CAH avec et sans consolidation.

```{r}
before<-round(cah_milieu_scol_test$call$bw.before.consol,3)
after<-round(cah_milieu_scol_test$call$bw.after.consol,3)
tot<-cbind(before,after)
rownames(tot)<-"variance"
tot %>% tab_fun(above=F,title="Gain d'inertie après consolidation")
```

Nous pouvons constater une augmentation de l'inertie de 0.03 lorsque nous passons de sans à avec consolidation.

```{r}
cah_milieu_scol <- HCPC(acm_scol, nb.clust = 2, graph = FALSE, min = 2, max = 10, consol = TRUE)
```

On va regarder quels sont les axes qui représentent le mieux nos clusters afin de faire une représentation graphique :

```{r}
tab_fun(round(as.data.frame(cah_milieu_scol$desc.axes$quanti$"1"),3),
        title = "Les axes qui représentent le mieux le cluster 1")
tab_fun(round(as.data.frame(cah_milieu_scol$desc.axes$quanti$"2"),3),
        title = "Les axes qui représentent le mieux le cluster 2")
```

L'amas 1 est le mieux représenté par la dimension 2 et l'amas 2 est le mieux représenté par la dimension 1. Nous allons donc faire un graphique pour représenter les clusters sur les deux premiers axes :

```{r}
fviz_cluster(cah_milieu_scol, data = acm_scol, ellipse.type = "convex", 
             palette = "futurama", ggtheme = theme_minimal(), axes = c(1,2))

fviz_cluster(cah_milieu_scol, geom="point", ellipse = TRUE, show.clust.cent = FALSE, palette = "futurama", 
               ggtheme = theme_minimal()) + lims(x= c(-1,1)) + 
    labs(title= "CAH avec 2 clusters")
```

Nous allons maintenant regarder les modalités pour chaque amas afin de comprendre ce que représente nos deux clusters. Voici un premier tableau sur les modalités du cluster 1 :

```{r}
mod_classe(cah_milieu_scol, nbr_classe = 1:2, sup=7)
classe_1
```

La modalité la mieux représentée correspond à l'école Gabriel Pereira. On remarque que 95% des étudiants du cluster sont de l'école Gabriel Pereira. De plus, les modalités higher_yes, trav < 15, failures_0 et U sont surreprésentés. Ainsi, 99.8% des étudiants du cluster veulent faire des études supérieures, 75% habitent à moins de 15 minutes, 94% n'ont jamais redoublé et 83.3% vivent en ville. Nous remarquons donc que les étudiants de ce groupe sont plutôt de bons étudiants (ne redoublent pas, veulent faire des études supérieures), qui habitent en ville (donc un temps de trajet plus court).
Nous allons maintenant regarder les modalités du deuxième cluster :

```{r}
classe_2
```

La modalité la mieux représentée est l'école Mousinho da Silveira. On remarque que 68.6% des étudiants de ce cluster sont dans l'école alors que cette modalité ne représente que 26% de la variable. De plus, les autres modalités qui représentent le mieux ce cluster sont higher_no, stud < 2h, R, trav 30-1h. Cependant, toutes ces modalités représentent une faible proportion de la variable (respectivement : 8%, 30%, 27% et 7%) mais on remarque que dans ce cluster, on retrouve 99% des étudiants ne voulant pas faire d'études supérieures, 59% des étudiants travaillant moins de 2 heures, 59% des étudiants vivant à la campagne et 86.5% des étudiants qui ont un trajet qui dure entre 30 minutes et 1 heure. Cet amas représente donc plutôt les mauvais étudiants (ceux qui ne veulent pas faire d'études supérieures, qui travaillent moins de 2 heures par semaine) et les étudiants qui habitent à la campagne (et par conséquent, qui ont des trajets plus longs).

En conclusion, notre classification ascendante hiérarchique a construit 2 clusters, l'un correspondant à l'école Mousinho da Silveira et l'autre correspondant à l'école Gabriel Pereira, ce qui nous montre les différences entre les 2 écoles. Il nous semblerait donc que les étudiants de l'école Mousinho da Silveira sont plutôt de mauvais étudiants qui vivent en campagne et les étudiants de l'école Gabriel Pereira sont plutôt de bons étudiants vivant en ville. Nous sommes donc peut-être en train d'observer les inégalités d'éducation au Portugal entre les étudiants habitant à la ville et ceux habitant à la campagne.


\newpage 

# Conclusion

Après avoir décidé de séparer notre base de données en trois axes de travail, nous avons pu constater l'importance de nombreuses variables pour expliquer la performance des étudiants portugais.

$1.$ Pour l'environnement familial, le niveau d'éducation et les catégories socioprofessionnelles des parents ont un effet sur la performance de leur enfant. Plus le niveau d'éducation des parents est élevé ou plus ils ont une CSP élevée, plus la moyenne de l'élève semble s'améliorer.

$2.$ Pour l'environnement extra-scolaire, nous avons pu observer que le niveau de temps libre, de sortie avec des amis et la consommation d'alcool avait un effet négatif sur la performance des étudiants si le niveau de ces trois variables était élevé.

$3.$ Pour l'environnement scolaire, le nombre de redoublement, le temps passé à étudier et la matière sont des facteurs importants dans les performances des étudiants portugais. 
On constate également que l'école et donc le lieu d'habitation sont très important dans la réussite des étudiants.

